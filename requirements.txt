# ============================================================================
# CodeGuardian Dependencies - Kaggle Optimized (Conflict-Resolved)
# ============================================================================
# This requirements.txt resolves all major dependency conflicts for Kaggle
# Version constraints are carefully chosen for maximum compatibility
# ============================================================================

###############################
# Core Dependencies (Minimal)
###############################
pyyaml>=6.0
regex>=2023.0.0
openpyxl>=3.1.0
rich>=12.4.4,<14.0.0      # Pin to <14 for bigframes compatibility
requests>=2.31.0
click>=8.0.0
tqdm>=4.64.0
jsonschema>=4.17.0

###############################
# Web Frameworks (Optional)
###############################
# Commented out to reduce installation time and conflicts
# Uncomment if you need Django/Flask for web interface
# django>=4.2.0,<5.0.0
# flask>=2.3.0

###############################
# Machine Learning & Data Science
###############################
# CRITICAL: numpy version affects multiple packages
# - cesium needs >=2.0, but many Kaggle packages need <2.0
# - Using <2.0 for broader compatibility (cesium is optional)
numpy>=1.26.0,<2.0.0      # Keep 1.x for TensorFlow/cuDF compatibility
pandas>=2.2.0,<2.3.0
# FIXED: umap-learn requires scikit-learn>=1.6
scikit-learn>=1.6.0       # Upgraded to satisfy umap-learn
xgboost>=1.7.0
joblib>=1.3.0

###############################
# I/O & Caching
###############################
# Pin pyarrow to version compatible with both datasets and cudf
pyarrow>=19.0.0,<20.0.0   # Critical: cudf needs <20, datasets needs >=19

###############################
# Deep Learning & Transformers
###############################
torch>=2.0.0
transformers>=4.40.0
tokenizers>=0.19.0
datasets>=2.19.0
accelerate>=0.30.0
huggingface_hub>=0.23.0

###############################
# Monitoring & Logging
###############################
tensorboard>=2.18.0,<2.19.0
loguru>=0.7.0
memory_profiler>=0.61.0

###############################
# Security & Code Quality
###############################
bandit>=1.7.5

###############################
# Testing (Development only)
###############################
pytest>=7.0.0
pytest-cov>=4.0.0

###############################
# Google Cloud & BigQuery
###############################
# CRITICAL: Protobuf version must satisfy multiple packages
# - TensorFlow needs: >=3.20.3,<6.0.0
# - google-cloud-translate needs: >=3.19.5,<5.0.0
# - google-ai-generativelanguage needs: >=3.20.2,<6.0.0
# Using <5.0.0 as the safest common range
protobuf>=3.20.3,<5.0.0   # FIXED: Downgrade from 6.x to <5.0 for TF/GCP

# CONFLICT WARNING: google-cloud-automl requires google-api-core<2.0
# but bigquery-storage requires >=2.10.2
# RESOLUTION: Prioritize bigquery-storage (needed), exclude automl if installed
google-api-core>=2.10.2,<3.0.0
google-cloud-bigquery>=3.31.0
google-cloud-bigquery-storage>=2.30.0,<3.0.0

###############################
# Security & Encryption (for pydrive2 compatibility)
###############################
# FIXED: pydrive2 has strict version requirements
cryptography>=40.0.0,<44.0.0    # pydrive2 needs <44
pyOpenSSL>=19.1.0,<=24.2.1      # pydrive2 needs <=24.2.1

###############################
# Pydantic (for gradio compatibility)
###############################
# FIXED: gradio requires pydantic <2.12
pydantic>=2.0,<2.12

###############################
# RAPIDS/cuDF compatibility (Kaggle pre-installed)
###############################
# NOTE: RAPIDS library version conflicts (libraft, pylibraft, rmm)
# These are pre-installed on Kaggle at version 25.2.x
# If you see version 25.6.x conflicts, force downgrade:
# libraft-cu12==25.2.0
# pylibraft-cu12==25.2.0
# rmm-cu12==25.2.0
# libcugraph-cu12==25.2.2
# pylibcugraph-cu12==25.2.2