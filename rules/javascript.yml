rules:
  - id: JS-XSS-001
    name: "DOM XSS via innerHTML/outerHTML"
    pattern: "(?m)\\w+\\.(innerHTML|outerHTML|insertAdjacentHTML)\\s*=\\s*\\w+"
    cwe: "CWE-79"
    owasp: "A03:2021-Injection"
    severity: "HIGH"
    confidence: 0.8
    why: "Setting HTML content with untrusted input enables XSS."
    fix:
      type: "suggest"
      message: "Use textContent or sanitize HTML input."

  - id: JS-EVAL-001
    name: "Code injection via eval()"
    pattern: "(?m)\\beval\\s*\\("
    cwe: "CWE-95"
    owasp: "A03:2021-Injection"
    severity: "CRITICAL"
    confidence: 0.9
    why: "eval() executes arbitrary code from untrusted input."
    fix:
      type: "suggest"
      message: "Avoid eval(). Use JSON.parse() or safe alternatives."

  - id: JS-SQLI-001
    name: "SQL injection via string concatenation"
    pattern: "(?s)query\\s*\\(\\s*\".*\"\\s*\\+\\s*\\w+"
    cwe: "CWE-89"
    owasp: "A03:2021-Injection"
    severity: "HIGH"
    confidence: 0.8
    why: "Concatenating user input into SQL enables injection."
    fix:
      type: "suggest"
      message: "Use parameterized queries or prepared statements."

  - id: JS-CMDI-001
    name: "Command injection via child_process.exec"
    pattern: "(?m)child_process\\.exec\\s*\\("
    cwe: "CWE-78"
    owasp: "A03:2021-Injection"
    severity: "HIGH"
    confidence: 0.85
    why: "Executing shell commands with untrusted input enables RCE."
    fix:
      type: "suggest"
      message: "Validate/sanitize inputs or use safer alternatives."

  - id: JS-DESER-001
    name: "Insecure deserialization via JSON.parse"
    pattern: "(?m)JSON\\.parse\\s*\\(\\s*\\w+\\s*\\)"
    cwe: "CWE-502"
    owasp: "A08:2021-Software and Data Integrity Failures"
    severity: "MEDIUM"
    confidence: 0.6
    why: "JSON.parse can execute code if input is maliciously crafted."
    fix:
      type: "suggest"
      message: "Validate input before parsing or use safe parsers."

  - id: JS-HARDCODE-001
    name: "Hardcoded credentials"
    pattern: "(?m)(password|secret|key|token)\\s*[:=]\\s*[\"'][^\"']+[\"']"
    cwe: "CWE-798"
    owasp: "A05:2021-Security Misconfiguration"
    severity: "MEDIUM"
    confidence: 0.7
    why: "Hardcoded credentials can be extracted from source code."
    fix:
      type: "suggest"
      message: "Use environment variables or secure credential storage."
