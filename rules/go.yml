rules:
  - id: GO-SQLI-001
    name: "SQL injection via string concatenation"
    pattern: "(?s)Query\\s*\\(\\s*\".*\"\\s*\\+\\s*\\w+"
    cwe: "CWE-89"
    owasp: "A03:2021-Injection"
    severity: "HIGH"
    confidence: 0.8
    why: "Concatenating user input into SQL enables injection."
    fix:
      type: "suggest"
      message: "Use prepared statements (db.Prepare/db.Query)."

  - id: GO-CMDI-001
    name: "Command injection via exec.Command"
    pattern: "(?m)exec\\.Command\\s*\\("
    cwe: "CWE-78"
    owasp: "A03:2021-Injection"
    severity: "HIGH"
    confidence: 0.85
    why: "Executing commands with untrusted args enables RCE."
    fix:
      type: "suggest"
      message: "Validate/sanitize arguments or avoid shell execution."

  - id: GO-DESER-001
    name: "Insecure deserialization via gob/encoding"
    pattern: "(?m)(gob\\.|encoding/)\\w+\\.(Unmarshal|Decode)"
    cwe: "CWE-502"
    owasp: "A08:2021-Software and Data Integrity Failures"
    severity: "HIGH"
    confidence: 0.8
    why: "Untrusted gob/binary data can execute arbitrary code."
    fix:
      type: "suggest"
      message: "Validate input or use safe serialization formats."

  - id: GO-HARDCODE-001
    name: "Hardcoded credentials"
    pattern: "(?m)(password|secret|key|token)\\s*[:=]\\s*[\"'][^\"']+[\"']"
    cwe: "CWE-798"
    owasp: "A05:2021-Security Misconfiguration"
    severity: "MEDIUM"
    confidence: 0.7
    why: "Hardcoded credentials can be extracted from source code."
    fix:
      type: "suggest"
      message: "Use environment variables or secure config management."

  - id: GO-RAND-001
    name: "Weak random number generation"
    pattern: "(?m)math/rand\\.(Int|Intn|Float)"
    cwe: "CWE-338"
    owasp: "A02:2021-Cryptographic Failures"
    severity: "MEDIUM"
    confidence: 0.75
    why: "math/rand is predictable and unsuitable for security."
    fix:
      type: "suggest"
      message: "Use crypto/rand for security-sensitive operations."

  - id: GO-TLS-001
    name: "Insecure TLS configuration"
    pattern: "(?m)tls\\.Config\\s*\\{[^}]*InsecureSkipVerify\\s*:\\s*true"
    cwe: "CWE-295"
    owasp: "A05:2021-Security Misconfiguration"
    severity: "HIGH"
    confidence: 0.9
    why: "Skipping TLS verification exposes to MITM attacks."
    fix:
      type: "suggest"
      message: "Remove InsecureSkipVerify or implement proper certificate validation."
