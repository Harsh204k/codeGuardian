rules:
  - id: CS-SQLI-001
    name: "SQL Injection via string concatenation"
    pattern: "(?s)Sql(Command|DataAdapter)\\s*\\(\\s*\".*\"\\s*\\+\\s*\\w+"
    cwe: "CWE-89"
    owasp: "A03:2021-Injection"
    severity: "HIGH"
    confidence: 0.8
    why: "String-built SQL with user input enables injection."
    fix:
      type: "suggest"
      message: "Use parameterized queries (SqlParameter)."

  - id: CS-DESER-001
    name: "Insecure deserialization (BinaryFormatter)"
    pattern: "(?m)new\\s+BinaryFormatter\\s*\\("
    cwe: "CWE-502"
    owasp: "A08:2021-Software and Data Integrity Failures"
    severity: "HIGH"
    confidence: 0.8
    why: "BinaryFormatter is unsafe with untrusted input."
    fix:
      type: "suggest"
      message: "Use safe serializers (System.Text.Json/DataContractJsonSerializer)."
