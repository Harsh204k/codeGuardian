# Ruby Security Rules

rules:
  - id: ruby_eval_usage
    name: "Use of eval()"
    cwe_id: "CWE-94"
    severity: CRITICAL
    confidence: HIGH
    type: api_call
    api_names: [eval, instance_eval, class_eval, module_eval]
    description: "eval() executes arbitrary Ruby code"
    remediation: "Avoid eval(); use safe alternatives"
    
  - id: ruby_sql_injection
    name: "SQL Injection"
    cwe_id: "CWE-89"
    severity: HIGH
    confidence: MEDIUM
    type: regex
    pattern: '\.(find_by_sql|execute)\s*\([^)]*#\{'
    description: "SQL query with string interpolation"
    remediation: "Use parameterized queries"
    
  - id: ruby_command_injection
    name: "Command Injection"
    cwe_id: "CWE-78"
    severity: HIGH
    confidence: MEDIUM
    type: regex
    pattern: '(system|exec|`)\s*\([^)]*#\{'
    description: "Command execution with interpolation"
    remediation: "Validate command inputs"
    
  - id: ruby_deserialization
    name: "Insecure Deserialization"
    cwe_id: "CWE-502"
    severity: HIGH
    confidence: HIGH
    type: api_call
    api_names: [Marshal.load, YAML.load]
    description: "Unsafe deserialization"
    remediation: "Use YAML.safe_load or validate data"
