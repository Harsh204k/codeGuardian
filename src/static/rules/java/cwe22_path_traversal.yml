id: JAVA.CWE22.PATH.TRAVERSAL
name: Tainted file path used in file APIs
cwe: CWE-22
owasp: A01:2021-Broken Access Control
severity: high
languages: [java]
patterns:
  - 'new\s+File\s*\(\s*.*(getParameter|getHeader|getQueryString|getReader\s*\(\)\.readLine)\s*\('
  - 'Paths\.get\s*\(\s*.*(getParameter|getHeader|getQueryString|getReader\s*\(\)\.readLine)\s*\('
  - 'new\s+FileInputStream\s*\(\s*.*(getParameter|getHeader|getQueryString|getReader\s*\(\)\.readLine)\s*\('
  - 'Files\.(newInputStream|newOutputStream|readAllBytes|write)\s*\(\s*.*(getParameter|getHeader|getQueryString|getReader\s*\(\)\.readLine)\s*\('
