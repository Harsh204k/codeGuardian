# Java-Specific Security Rules

rules:
  - id: java_sql_injection_statement
    name: "SQL Injection via Statement"
    cwe_id: "CWE-89"
    severity: HIGH
    confidence: HIGH
    type: regex
    pattern: 'Statement\s+\w+\s*=.*\.createStatement\s*\('
    description: "Use of Statement instead of PreparedStatement"
    remediation: "Use PreparedStatement with parameterized queries"
    
  - id: java_weak_cipher
    name: "Weak Cipher Algorithm"
    cwe_id: "CWE-327"
    severity: HIGH
    confidence: HIGH
    type: regex
    pattern: 'Cipher\.getInstance\s*\(\s*"(DES|RC2|RC4|Blowfish)"'
    description: "Use of weak or obsolete cipher algorithm"
    remediation: "Use AES with GCM mode"
    
  - id: java_weak_hash
    name: "Weak Hash Algorithm"
    cwe_id: "CWE-327"
    severity: MEDIUM
    confidence: HIGH
    type: regex
    pattern: 'MessageDigest\.getInstance\s*\(\s*"(MD5|SHA-1|SHA1)"'
    description: "Use of weak hash algorithm"
    remediation: "Use SHA-256 or SHA-3"
    
  - id: java_random_predictable
    name: "Predictable Random Numbers"
    cwe_id: "CWE-338"
    severity: MEDIUM
    confidence: HIGH
    type: regex
    pattern: 'new\s+Random\s*\('
    description: "java.util.Random is not cryptographically secure"
    remediation: "Use SecureRandom for security-sensitive operations"
    
  - id: java_trust_all_certificates
    name: "Trust All SSL Certificates"
    cwe_id: "CWE-295"
    severity: HIGH
    confidence: HIGH
    type: regex
    pattern: 'TrustManager\[\]\s*=\s*new\s*TrustManager|X509TrustManager.*checkClientTrusted.*\{\s*\}'
    description: "Disabling SSL certificate validation"
    remediation: "Properly validate SSL certificates"
    
  - id: java_hardcoded_password
    name: "Hard-coded Password in JDBC"
    cwe_id: "CWE-798"
    severity: HIGH
    confidence: MEDIUM
    type: regex
    pattern: 'DriverManager\.getConnection\s*\([^)]*,\s*"[^"]+"\s*,\s*"[^"]+"'
    description: "Hard-coded database credentials"
    remediation: "Use configuration files or environment variables"
    
  - id: java_path_traversal
    name: "Path Traversal in File Operations"
    cwe_id: "CWE-22"
    severity: MEDIUM
    confidence: MEDIUM
    type: regex
    pattern: 'new\s+File\s*\([^)]*request\.getParameter'
    description: "File path from user input without validation"
    remediation: "Validate and canonicalize file paths"
    
  - id: java_reflected_xss
    name: "Reflected XSS in Servlet"
    cwe_id: "CWE-79"
    severity: HIGH
    confidence: MEDIUM
    type: regex
    pattern: 'response\.getWriter\(\)\.write\([^)]*request\.getParameter'
    description: "User input written to response without escaping"
    remediation: "Escape HTML output or use templating engine"
