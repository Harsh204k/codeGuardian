# CWE-22: Path Traversal Rules

rules:
  - id: path_traversal_file_open
    name: "Path Traversal in File Operations"
    cwe_id: "CWE-22"
    severity: MEDIUM
    confidence: MEDIUM
    type: regex
    pattern: '(open|fopen|readFile|File|FileInputStream)\s*\([^)]*\+[^)]*\)'
    description: "File path constructed with string concatenation"
    remediation: "Validate and canonicalize file paths; use allowlist"
    languages: [all]
    
  - id: path_traversal_dotdot
    name: "Path Traversal Pattern Detection"
    cwe_id: "CWE-22"
    severity: HIGH
    confidence: LOW
    type: regex
    pattern: '\.\./|\.\.\\'
    description: "Potential directory traversal pattern in code"
    remediation: "Validate paths and reject ../ sequences"
    languages: [all]
    
  - id: path_traversal_user_input
    name: "Path Traversal from User Input"
    cwe_id: "CWE-22"
    severity: HIGH
    confidence: MEDIUM
    type: regex
    pattern: '(req\.(params|query|body)|request\.(GET|POST)|_GET\[|_POST\[)\s*\[[^\]]*\]\s*.*?(open|read|include)'
    description: "File operation using unvalidated user input"
    remediation: "Validate file paths against allowlist"
    languages: [javascript, php, python]
