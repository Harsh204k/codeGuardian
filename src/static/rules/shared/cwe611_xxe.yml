# CWE-611: XML External Entity (XXE) Injection Rules

rules:
  - id: xxe_python_etree
    name: "XXE in Python xml.etree"
    cwe_id: "CWE-611"
    severity: MEDIUM
    confidence: MEDIUM
    type: regex
    pattern: 'xml\.etree\.ElementTree\.(parse|fromstring|XMLParser)'
    description: "Python XML parsing without XXE protection"
    remediation: "Use defusedxml library or disable external entities"
    languages: [python]
    
  - id: xxe_java_documentbuilder
    name: "XXE in Java DocumentBuilder"
    cwe_id: "CWE-611"
    severity: MEDIUM
    confidence: MEDIUM
    type: regex
    pattern: 'DocumentBuilderFactory\.newInstance\s*\(\)'
    description: "DocumentBuilder without disabling external entities"
    remediation: "Set feature disallow-doctype-decl to true"
    languages: [java]
    
  - id: xxe_php_simplexml
    name: "XXE in PHP SimpleXML"
    cwe_id: "CWE-611"
    severity: MEDIUM
    confidence: MEDIUM
    type: api_call
    api_names: [simplexml_load_string, simplexml_load_file]
    description: "PHP XML parsing without XXE protection"
    remediation: "Disable libxml_disable_entity_loader"
    languages: [php]
