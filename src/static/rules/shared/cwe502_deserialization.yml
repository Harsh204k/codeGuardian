# CWE-502: Deserialization of Untrusted Data Rules

rules:
  - id: deserialization_pickle
    name: "Insecure Pickle Deserialization"
    cwe_id: "CWE-502"
    severity: HIGH
    confidence: HIGH
    type: api_call
    api_names: [pickle.loads, pickle.load, cPickle.loads, cPickle.load]
    description: "Pickle deserialization can execute arbitrary code"
    remediation: "Use json.loads or verify data source integrity"
    languages: [python]
    
  - id: deserialization_yaml
    name: "Unsafe YAML Deserialization"
    cwe_id: "CWE-502"
    severity: HIGH
    confidence: HIGH
    type: regex
    pattern: 'yaml\.load\s*\((?!.*Loader\s*=\s*yaml\.SafeLoader)'
    description: "yaml.load() without SafeLoader can execute code"
    remediation: "Use yaml.safe_load() or yaml.load with SafeLoader"
    languages: [python]
    
  - id: deserialization_java_readobject
    name: "Java Deserialization"
    cwe_id: "CWE-502"
    severity: HIGH
    confidence: MEDIUM
    type: api_call
    api_names: [readObject, ObjectInputStream]
    description: "Java deserialization of untrusted data"
    remediation: "Implement input validation and use look-ahead deserialization"
    languages: [java]
    
  - id: deserialization_php_unserialize
    name: "PHP Unserialize"
    cwe_id: "CWE-502"
    severity: HIGH
    confidence: HIGH
    type: api_call
    api_names: [unserialize]
    description: "PHP unserialize() can lead to object injection"
    remediation: "Use json_decode() or validate serialized data"
    languages: [php]
