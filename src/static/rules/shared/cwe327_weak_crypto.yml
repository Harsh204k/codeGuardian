# CWE-327: Use of Broken or Risky Cryptographic Algorithm Rules

rules:
  - id: weak_crypto_md5
    name: "Use of MD5 Hash"
    cwe_id: "CWE-327"
    severity: MEDIUM
    confidence: HIGH
    type: keyword
    keywords: [MD5, md5, hashlib.md5, MessageDigest.getInstance("MD5")]
    description: "MD5 is cryptographically broken"
    remediation: "Use SHA-256 or SHA-3 instead"
    languages: [all]
    
  - id: weak_crypto_sha1
    name: "Use of SHA-1 Hash"
    cwe_id: "CWE-327"
    severity: MEDIUM
    confidence: HIGH
    type: keyword
    keywords: [SHA1, sha1, hashlib.sha1, MessageDigest.getInstance("SHA-1")]
    description: "SHA-1 is deprecated and weak"
    remediation: "Use SHA-256 or SHA-3"
    languages: [all]
    
  - id: weak_crypto_des
    name: "Use of DES Encryption"
    cwe_id: "CWE-327"
    severity: HIGH
    confidence: HIGH
    type: keyword
    keywords: [DES, Cipher.getInstance("DES")]
    description: "DES encryption is obsolete and insecure"
    remediation: "Use AES-256 or ChaCha20"
    languages: [all]
    
  - id: weak_crypto_ecb_mode
    name: "Use of ECB Mode"
    cwe_id: "CWE-327"
    severity: MEDIUM
    confidence: HIGH
    type: regex
    pattern: 'Cipher\.getInstance\s*\([^)]*ECB[^)]*\)'
    description: "ECB mode is insecure (deterministic)"
    remediation: "Use GCM or CBC mode with random IV"
    languages: [java, python]
